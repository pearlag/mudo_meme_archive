---
alwaysApply: true
---
# ğŸ¯ Project Rules - ë¬´ë„ì§¤ì•„ì¹´ì´ë¸Œ (Mudo Meme Library)

## ğŸ“ Architecture Rules

### Framework & Structure
- âœ… **Use Next.js 16+ App Router** exclusively for routing and page structure
- âœ… **Server Components by default** - Only add `"use client"` when necessary (hooks, browser APIs, event handlers)
- âœ… **File-based routing** - Follow Next.js App Router conventions (`app/` directory)
- âœ… **TypeScript** - All new files must be TypeScript (`.ts` or `.tsx`)

### Component Architecture
- âœ… **Component composition** - Build complex UIs from smaller, reusable components
- âœ… **Single Responsibility** - Each component should have one clear purpose
- âœ… **Props interface** - Always define TypeScript interfaces for component props
- âœ… **Client components** - Mark with `"use client"` at the top when using:
  - React hooks (`useState`, `useEffect`, etc.)
  - Browser APIs (`window`, `localStorage`, etc.)
  - Event handlers (`onClick`, `onChange`, etc.)
  - Context consumers

### State Management
- âœ… **Local state** - Use `useState` and `useEffect` for component-level state
- âœ… **Server state** - Use TanStack Query for server data (when implemented)
- âœ… **Direct Supabase calls** - Allowed for simple CRUD operations
- âœ… **No global state library** - Avoid Redux/Zustand unless absolutely necessary
- âœ… **Custom hooks** - Extract reusable state logic into custom hooks (`useUserRole`, `useToast`)

### Data Fetching
- âœ… **Supabase client** - Always use `@/integrations/supabase/client` for database operations
- âœ… **Error handling** - Always handle errors and provide fallback to mock data
- âœ… **Loading states** - Always show loading indicators during async operations
- âœ… **Environment variables** - Use `NEXT_PUBLIC_` prefix for client-accessible env vars

### File Organization
```
src/
â”œâ”€â”€ app/              # Next.js App Router pages
â”œâ”€â”€ components/       # React components
â”‚   â””â”€â”€ ui/          # shadcn/ui components
â”œâ”€â”€ hooks/           # Custom React hooks
â”œâ”€â”€ lib/             # Utility functions
â”œâ”€â”€ types/           # TypeScript type definitions
â”œâ”€â”€ integrations/    # Third-party service integrations
â””â”€â”€ data/            # Mock data and constants
```

---

## ğŸ¨ Styling Rules

### CSS Framework
- âœ… **Tailwind CSS only** - Use Tailwind utility classes for all styling
- âœ… **No inline styles** - Avoid `style={{}}` prop unless absolutely necessary
- âœ… **CSS Variables** - Use design tokens from `globals.css` for colors, spacing, etc.
- âœ… **Dark mode** - Support dark mode using `dark:` prefix and CSS variables

### Component Styling
- âœ… **shadcn/ui components** - Use existing UI components from `@/components/ui`
- âœ… **cn() utility** - Always use `cn()` from `@/lib/utils` for conditional classes
- âœ… **Responsive design** - Use Tailwind breakpoints (`sm:`, `md:`, `lg:`, `xl:`)
- âœ… **Consistent spacing** - Use Tailwind spacing scale (4px increments)

### Design System
- âœ… **Color palette** - Use CSS variables defined in `globals.css`:
  - `--primary`, `--secondary`, `--accent`
  - `--background`, `--foreground`
  - `--muted`, `--border`
- âœ… **Typography** - Use Tailwind typography utilities
- âœ… **Shadows** - Use custom shadow tokens (`shadow-card`, `shadow-hover`)
- âœ… **Transitions** - Use `transition-smooth` class for animations

### Styling Patterns
```typescript
// âœ… Good - Using cn() utility
<div className={cn("base-classes", isActive && "active-classes", className)}>

// âŒ Bad - String concatenation
<div className={"base-classes " + (isActive ? "active-classes" : "")}>
```

---

## ğŸ“ Coding Conventions

### TypeScript
- âœ… **Type safety** - Define types for all props, functions, and data structures
- âœ… **Interface over type** - Prefer `interface` for object shapes
- âœ… **Type exports** - Export types from `src/types/` directory
- âœ… **Avoid `any`** - Use `unknown` or proper types instead

### Naming Conventions
- âœ… **Components**: PascalCase (`MemeCard.tsx`, `DashboardLayout.tsx`)
- âœ… **Hooks**: camelCase with `use` prefix (`useUserRole`, `useToast`)
- âœ… **Functions**: camelCase (`fetchMemes`, `handleClick`)
- âœ… **Constants**: UPPER_SNAKE_CASE or camelCase (`TOAST_LIMIT`, `mockMemes`)
- âœ… **Types/Interfaces**: PascalCase (`Meme`, `Category`, `UserRole`)
- âœ… **Files**: Match export name (component files = PascalCase, others = kebab-case)

### Code Structure
```typescript
// âœ… Good - Proper structure
"use client"; // If needed

import { ... } from "...";
import type { ... } from "...";

interface ComponentProps {
  // Props definition
}

export function Component({ prop1, prop2 }: ComponentProps) {
  // Hooks
  // State
  // Effects
  // Handlers
  // Render
}
```

### Import Order
1. React and Next.js imports
2. Third-party library imports
3. Internal component imports
4. Utility/helper imports
5. Type imports (`import type { ... }`)
6. Relative imports

### Component Patterns
- âœ… **Functional components** - Always use function components (not class components)
- âœ… **Arrow functions** - Use for component exports: `export const Component = () => {}`
- âœ… **Named exports** - Prefer named exports over default exports for components
- âœ… **Props destructuring** - Destructure props in function parameters

### Error Handling
- âœ… **Try-catch blocks** - Always wrap async operations in try-catch
- âœ… **Error logging** - Use `console.error()` for debugging
- âœ… **User feedback** - Show toast notifications for errors using `toast.error()`
- âœ… **Fallback data** - Provide mock data fallback when API fails

### Comments & Documentation
- âœ… **Korean comments** - Write comments in Korean for business logic
- âœ… **English for code** - All code, variables, and functions in English
- âœ… **JSDoc** - Add JSDoc comments for complex functions
- âœ… **TODO comments** - Mark incomplete features with `// TODO: description`

---

## ğŸ” Security & Best Practices

### Authentication
- âœ… **Supabase Auth** - Use Supabase authentication exclusively
- âœ… **Session management** - Rely on Supabase session handling
- âœ… **Protected routes** - Check authentication before sensitive operations
- âœ… **Role-based access** - Use `useUserRole` hook for permission checks

### Data Security
- âœ… **RLS policies** - Database security handled by Supabase RLS
- âœ… **Input validation** - Use Zod schemas for form validation
- âœ… **Environment variables** - Never commit secrets to git
- âœ… **Client-side validation** - Validate user input before API calls

### Performance
- âœ… **Image optimization** - Consider using Next.js `Image` component for better performance
- âœ… **Code splitting** - Leverage Next.js automatic code splitting
- âœ… **Lazy loading** - Use dynamic imports for heavy components
- âœ… **Memoization** - Use `useMemo` and `useCallback` when appropriate

---

## ğŸ§ª Testing & Quality

### Code Quality
- âœ… **ESLint** - Follow Next.js ESLint rules
- âœ… **Type checking** - Ensure TypeScript compiles without errors
- âœ… **Consistent formatting** - Maintain consistent code style
- âœ… **No console.log** - Remove debug logs before committing (use `console.error` for errors)

### Git Conventions
- âœ… **Commit messages** - Write clear, descriptive commit messages
- âœ… **Branch naming** - Use descriptive branch names (`feature/add-search`, `fix/auth-bug`)
- âœ… **Small commits** - Make focused, atomic commits

---

## ğŸ“¦ Dependencies

### Adding New Dependencies
- âœ… **Check existing** - Verify if similar functionality exists in current dependencies
- âœ… **shadcn/ui first** - Prefer shadcn/ui components over new UI libraries
- âœ… **TypeScript support** - Ensure library has TypeScript definitions
- âœ… **Bundle size** - Consider impact on bundle size

### Preferred Libraries
- âœ… **UI Components**: shadcn/ui (Radix UI)
- âœ… **Icons**: Lucide React
- âœ… **Forms**: React Hook Form + Zod
- âœ… **Notifications**: Sonner
- âœ… **Date handling**: date-fns
- âœ… **Charts**: Recharts (if needed)

---

## ğŸš« Anti-Patterns to Avoid

- âŒ **Don't use class components** - Use functional components only
- âŒ **Don't mix state management** - Stick to one pattern (hooks, not Redux)
- âŒ **Don't bypass TypeScript** - Avoid `as any` or `@ts-ignore`
- âŒ **Don't hardcode values** - Use constants or environment variables
- âŒ **Don't ignore errors** - Always handle error cases
- âŒ **Don't create deep prop drilling** - Use composition or context if needed
- âŒ **Don't use inline styles** - Use Tailwind classes instead
- âŒ **Don't commit sensitive data** - No API keys, passwords, or secrets

---

## ğŸ“š Project-Specific Conventions

### Meme Data Structure
```typescript
interface Meme {
  id: string;
  imageUrl: string;
  title: string;
  episode: string;
  quote: string;
  category: Category;
  tags: Emotion[];
  likes: number;
  isFavorite: boolean;
}
```

### Category Types
- Use predefined categories: `"ìœ ì¬ì„" | "ë°•ëª…ìˆ˜" | "ì •í˜•ëˆ" | "ì •ì¤€í•˜" | "í•˜í•˜" | "ë…¸í™ì² " | "ê¸¸" | "ì „ì²´"`
- Don't add new categories without updating the type definition

### Image Handling
- âœ… Store images in `public/` directory for static assets
- âœ… Use Supabase Storage for user-uploaded images
- âœ… Always provide `alt` text for images
- âœ… Handle image loading errors gracefully

### API Patterns
```typescript
// âœ… Good - Error handling with fallback
const fetchMemes = async () => {
  try {
    const { data, error } = await supabase.from("memes").select("*");
    if (error) {
      console.error("Error:", error);
      setMemes(mockMemes); // Fallback
      return;
    }
    setMemes(data);
  } catch (error) {
    console.error("Error:", error);
    setMemes(mockMemes);
  }
};
```

---

## ğŸ¯ Quick Reference

### Path Aliases
- `@/components` â†’ `src/components`
- `@/lib` â†’ `src/lib`
- `@/hooks` â†’ `src/hooks`
- `@/types` â†’ `src/types`
- `@/integrations` â†’ `src/integrations`

### Common Imports
```typescript
// Supabase
import { supabase } from "@/integrations/supabase/client";

// Types
import type { Meme, Category } from "@/types/meme";

// Utils
import { cn } from "@/lib/utils";

// Components
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";

// Hooks
import { useUserRole } from "@/hooks/useUserRole";
```

### Environment Variables
```env
NEXT_PUBLIC_SUPABASE_URL=...
NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=...
```

---

**Last Updated**: 2025-11-17  
**Project**: ë¬´ë„ì§¤ì•„ì¹´ì´ë¸Œ (Mudo Meme Library)  
**Framework**: Next.js 16 + React 19 + TypeScript + Supabase

